

# 目录





# 单个APP进程内存的限制

## APP进程内存限制---配置

java程序 跑在jvm（dalvik或者art）上 ： https://zhuanlan.zhihu.com/p/655658126

1、一个java APP 对应一个 jvm

2、jvm必须限制内存，比如AS 就会设置最大内存

------> 安卓：

设置位置：

> 代码态：/dalvik/vm/alloc/HeapSource.cpp下找到原型
>
> https://www.cnblogs.com/mengfanrong/p/5186418.html
>
> 系统文件态：/system/build.prop
>
> 运行态：
>
> ```java
> val manager = getSystemService(Context.ACTIVITY_SERVICE) as ActivityManager
> manager.memoryClass
> ```

## APP进程内存限制--原理：

> 超出512M，抛出OOM异常
>
> 机制具体代码级流程：TODO: 谁检测，谁抛异常
>
> > https://zhuanlan.zhihu.com/p/652086402    Java OOM 演示

注意：

> 以上设置是针对于 dalvik的---------> 自然，不包括native申请的内存
>
> https://zhuanlan.zhihu.com/p/652086402

## 维测

https://blog.csdn.net/jscese/article/details/37928823   Android——内存调试

### **整体内存 ------ procrank**

https://blog.csdn.net/qinhai1989/article/details/88112715

procrank 安卓命令

> 几种内存：
>
> ```java
> VSS - Virtual Set Size 虚拟耗用内存（包含共享库占用的内存）
> RSS - Resident Set Size 实际使用物理内存（包含共享库占用的内存）
> PSS - Proportional Set Size 实际使用的物理内存（比例分配共享库占用的内存）
> USS - Unique Set Size 进程独自占用的物理内存（不包含共享库占用的内存）
> ```





### **指定进程 --------- dumpsys meminfo (包名或者PID)**

### 占用内存最多的进程或线程

**top -m 10**     当前占用最高内存的10个进程





# 维测dumpsys meminfo

https://blog.csdn.net/weixin_43886680/article/details/121017741   dumpsys meminfo内存分析解读(收集整合）

